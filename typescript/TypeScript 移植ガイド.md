TypeScript 移植ガイド

(1) "use strict"; する

変数の宣言がされていない場合は TypeScript でもエラーになります。
さきに JavaScript のコードをきれいにしておきます。
これをやっておかないと、あとで js -> ts のステップが大きくなりちょっと面倒です。

グローバルな関数での this の使用は TypeScript では可能ですが、
トラブルが多いので基本的には使うべきでないでしょう。ここで可能な限り取り除いておきます。


(1) 予約語を置き換える

"use strict";　でも検出できない予約語として module や extends があります。

ソースコードして grep して TypeScript の予約語をすべて探し出し、衝突しない別の識別子に置き換えます。
module という予約語は衝突しやすく、たとえば node.js の module オブジェクトはそのままではパースエラーになることがあります。
この場合、括弧で囲って (module) と書くと回避できることがあります。
式の文脈では module というトークンを識別子としてパースできるからです。

また、

    hoge.module 

というような式について

	(<any>hoge)["module"] 

のような式で置き換えて回避できる場合があります。

完了したらもちろんテストを実行します。

(2)

対象のソースファイルのファイル名を *.js から *.ts に変更します。

(2) :any, ? を追加する

型推論で変数の型が限定される式については、:any を変数の型注釈に追加して型エラーを回避します。

また、JavaScript は引数の数が足りなくても問題ないので、引数が足りない呼び出しが行われている関数の引数に ? を追加します。

(3) <any> を追加する

型の不整合が生じたら、とにかくそこに <any> を追加します。何も考えず <any> を追加します。
とにかく <any> を追加します。

(4) コンパイルしてテスト

コンパイルしてテストします。これでうまく行けば一安心。






